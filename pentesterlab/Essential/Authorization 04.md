# Write Up

## Challenge name
Authorization 04

## description

When people started building websites with databases to store information, they had to do write a lot of SQL manually. However, some people realized that this was not the best solution and started working on smarter alternatives, building Object-Relational Mapping (ORM) to easily query the database without any SQL knowledge.

For example, in Ruby (using ActiveRecord), you can do things like:

@user = User.find_by_name('pentesterlab')
Copy
This will automatically generate and execute the query, then retrieve the result in a User object.

Another really handy usage is to automatically create and update an object from a hash:

@user = User.create(myhash) 
[...]
@user.update_attributes(anotherhash)
Copy
Unfortunately, this useful feature comes with a security price.

If a developer did not correctly ensure that attributes of the object @user were protected, an attacker could arbitrarily overwrite any of these attributes. In this section, we will see some common examples of these types of issues: Mass-Assignment.

In this example, you can register a user. The application has two levels of privileges:

User.
Admin.
The admin privilege is set using the attribute admin on the object user. If you look closely at the format used by the web application: user[username] and user[password], you should be able to find a way to get admin access. Three methods can be used:

Modify the page directly using a browser extension.
Save the page and modify offline to create a page that will send the right payload to the right URL.
Use a proxy to intercept the legitimate request and add your parameter (the fastest option).

## solution
- go to the url
- there is a form to register an user
  - using myuser:mypass
  - we an error "You don't have admin privileges."
- check again myuser:mypass
- check the code
```
<form action="/signup" method="post">
  Username: <input type="text" name="user[username]">
  Password: <input type="password" name="user[password]">
  <input type="submit" name="submit">
</form>
```
- we can se some parameters for "user"
  - user[username]
  - user[password]
- using a proxy we get:
  - user[username]=myuser&user[password]=myuser&submit=Enviar
- user could have more parameters, which we could access using the brackets
- after trying i got a response with
  - ser[admin]
  - which we could set to true and send it with the form
- using burp submit
```
user[username]=myuser&
user[password]=myuser&
user[admin]=true&
submit=Enviar
```
- to pass admin privileges
- after forwarding the request we get a response
- we got admin privileges and the flag is shown in the page

## flag
```
flag{}
```
<details>
  <summary>Example</summary>

  ```
  long console output here
  ```
</details>