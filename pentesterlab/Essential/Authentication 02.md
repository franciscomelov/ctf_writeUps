# Write Up

## Challenge name
Authentication 02

## description
This example is similar to the previous example.
As soon as you receive a cookie from an application, it is always good to see what it looks like.

Try to crack it using a password cracker or try to just Google it. From there you should be able to generate a valid cookie for the user admin..

## solution
- go to the url
- create a new user
  - user:password
- we get a cookie for "user"
```
{"url":"https://ptl-fe306b2f339c-92a9817a8796.libcurl.me","cookies":[{"domain":"ptl-fe306b2f339c-92a9817a8796.libcurl.me","hostOnly":true,"httpOnly":false,"name":"auth","path":"/","sameSite":"unspecified","secure":false,"session":true,"storeId":"0","value":"ee11cbb19052e40b07aac0ca060c23ee"}]}
```
and a value for the user, the value is encypted
```
..."value":"ee11cbb19052e40b07aac0ca060c23ee"
```
- as a test I created a new user
  - user2:pass
```
{"url":"https://ptl-fe306b2f339c-92a9817a8796.libcurl.me","cookies":[{"domain":"ptl-fe306b2f339c-92a9817a8796.libcurl.me","hostOnly":true,"httpOnly":false,"name":"auth","path":"/","sameSite":"unspecified","secure":false,"session":true,"storeId":"0","value":"7e58d63b60197ceb55a1c487989a3720"}]}
```
again, an encryspted value, same length
```
..."value":"7e58d63b60197ceb55a1c487989a3720"
```
-using CyberChef and "analize hash" we get
```
Based on the length, this hash could have been generated by one of the following hashing functions:
MD5
MD4
MD2
HAVAL-128
RIPEMD-128
Snefru
Tiger-128
```
- trying first for an md5 hash
- using an md5 hash reverser
- reversing this values
  - ee11cbb19052e40b07aac0ca060c23ee
  - the result is "user"
- reversing the second value
  - 7e58d63b60197ceb55a1c487989a3720
  - the result is "user2"
- We can asume that the value is the result of hasing the user using MD5
- Now getting the md5 hash from the word "admin"
  - the result is 21232f297a57a5a743894a0e4a801fc3

- Now changing the value, replacing the hash for user for the hash of admin
  ```
  21232f297a57a5a743894a0e4a801fc3
  ```
- exporting the new cookie with the new values, gives us admin access

## flag
```
flag{}
```